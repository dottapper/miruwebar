<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>miru-WebAR è¨ºæ–­ãƒšãƒ¼ã‚¸</title>
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .header h1 {
            color: #7C4DFF;
            margin-bottom: 0.5rem;
        }
        .test-section {
            background-color: #242424;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid #444;
        }
        .test-section h3 {
            color: #00BCD4;
            margin-top: 0;
        }
        .status {
            padding: 0.5rem;
            border-radius: 4px;
            margin: 0.5rem 0;
        }
        .status.success {
            background-color: #4CAF50;
            color: white;
        }
        .status.error {
            background-color: #F44336;
            color: white;
        }
        .status.warning {
            background-color: #FF9800;
            color: white;
        }
        .status.info {
            background-color: #2196F3;
            color: white;
        }
        button {
            background: linear-gradient(135deg, #7C4DFF, #4A148C);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 0.5rem;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
        }
        .log {
            background-color: #1a1a1a;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>miru-WebAR è¨ºæ–­ãƒšãƒ¼ã‚¸</h1>
            <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ä½œçŠ¶æ³ã‚’ç¢ºèªã—ã¾ã™</p>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ åŸºæœ¬ç’°å¢ƒãƒã‚§ãƒƒã‚¯</h3>
            <div id="basic-tests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“¦ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h3>
            <div id="module-tests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ—„ï¸ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ</h3>
            <div id="storage-tests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¨ CSSèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h3>
            <div id="css-tests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ ãƒ­ã‚°å‡ºåŠ›</h3>
            <div id="log-output" class="log"></div>
            <button onclick="clearLog()">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
        </div>
    </div>

    <script>
        const logOutput = document.getElementById('log-output');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.color = type === 'error' ? '#F44336' : 
                                 type === 'success' ? '#4CAF50' : 
                                 type === 'warning' ? '#FF9800' : '#2196F3';
            logEntry.textContent = `[${timestamp}] ${message}`;
            logOutput.appendChild(logEntry);
            logOutput.scrollTop = logOutput.scrollHeight;
        }

        function clearLog() {
            logOutput.innerHTML = '';
        }

        function addStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            const status = document.createElement('div');
            status.className = `status ${type}`;
            status.textContent = message;
            element.appendChild(status);
        }

        // åŸºæœ¬ç’°å¢ƒãƒã‚§ãƒƒã‚¯
        function runBasicTests() {
            log('ğŸ”§ åŸºæœ¬ç’°å¢ƒãƒã‚§ãƒƒã‚¯é–‹å§‹');
            
            // JavaScriptå‹•ä½œç¢ºèª
            try {
                addStatus('basic-tests', 'âœ… JavaScript: æ­£å¸¸å‹•ä½œ', 'success');
                log('JavaScriptå‹•ä½œç¢ºèª: æˆåŠŸ', 'success');
            } catch (error) {
                addStatus('basic-tests', 'âŒ JavaScript: ã‚¨ãƒ©ãƒ¼', 'error');
                log(`JavaScriptå‹•ä½œç¢ºèª: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
            }

            // DOMæ“ä½œç¢ºèª
            try {
                const testElement = document.createElement('div');
                testElement.textContent = 'ãƒ†ã‚¹ãƒˆ';
                document.body.appendChild(testElement);
                document.body.removeChild(testElement);
                addStatus('basic-tests', 'âœ… DOMæ“ä½œ: æ­£å¸¸å‹•ä½œ', 'success');
                log('DOMæ“ä½œç¢ºèª: æˆåŠŸ', 'success');
            } catch (error) {
                addStatus('basic-tests', 'âŒ DOMæ“ä½œ: ã‚¨ãƒ©ãƒ¼', 'error');
                log(`DOMæ“ä½œç¢ºèª: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
            }

            // ãƒ–ãƒ©ã‚¦ã‚¶æ©Ÿèƒ½ç¢ºèª
            const features = {
                'localStorage': typeof localStorage !== 'undefined',
                'indexedDB': typeof indexedDB !== 'undefined',
                'fetch': typeof fetch !== 'undefined',
                'Promise': typeof Promise !== 'undefined',
                'async/await': (async () => {}).constructor.name === 'AsyncFunction'
            };

            Object.entries(features).forEach(([feature, available]) => {
                if (available) {
                    addStatus('basic-tests', `âœ… ${feature}: åˆ©ç”¨å¯èƒ½`, 'success');
                    log(`${feature}: åˆ©ç”¨å¯èƒ½`, 'success');
                } else {
                    addStatus('basic-tests', `âŒ ${feature}: åˆ©ç”¨ä¸å¯`, 'error');
                    log(`${feature}: åˆ©ç”¨ä¸å¯`, 'error');
                }
            });
        }

        // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ
        async function runModuleTests() {
            log('ğŸ“¦ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            const modules = [
                { name: 'QRCode', path: '/src/main.js' },
                { name: 'IndexedDB Storage', path: '/src/storage/indexeddb-storage.js' },
                { name: 'Project Store', path: '/src/storage/project-store.js' }
            ];

            for (const module of modules) {
                try {
                    const response = await fetch(module.path);
                    if (response.ok) {
                        addStatus('module-tests', `âœ… ${module.name}: èª­ã¿è¾¼ã¿å¯èƒ½`, 'success');
                        log(`${module.name}: èª­ã¿è¾¼ã¿å¯èƒ½`, 'success');
                    } else {
                        addStatus('module-tests', `âŒ ${module.name}: èª­ã¿è¾¼ã¿ä¸å¯ (${response.status})`, 'error');
                        log(`${module.name}: èª­ã¿è¾¼ã¿ä¸å¯ - ${response.status}`, 'error');
                    }
                } catch (error) {
                    addStatus('module-tests', `âŒ ${module.name}: ã‚¨ãƒ©ãƒ¼`, 'error');
                    log(`${module.name}: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
                }
            }
        }

        // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ
        async function runStorageTests() {
            log('ğŸ—„ï¸ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // localStorageãƒ†ã‚¹ãƒˆ
            try {
                localStorage.setItem('test', 'test-value');
                const testValue = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (testValue === 'test-value') {
                    addStatus('storage-tests', 'âœ… localStorage: æ­£å¸¸å‹•ä½œ', 'success');
                    log('localStorage: æ­£å¸¸å‹•ä½œ', 'success');
                } else {
                    addStatus('storage-tests', 'âŒ localStorage: å€¤ã®å–å¾—ã«å¤±æ•—', 'error');
                    log('localStorage: å€¤ã®å–å¾—ã«å¤±æ•—', 'error');
                }
            } catch (error) {
                addStatus('storage-tests', 'âŒ localStorage: ã‚¨ãƒ©ãƒ¼', 'error');
                log(`localStorage: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
            }

            // IndexedDBãƒ†ã‚¹ãƒˆ
            try {
                const request = indexedDB.open('test-db', 1);
                request.onerror = () => {
                    addStatus('storage-tests', 'âŒ IndexedDB: ã‚¨ãƒ©ãƒ¼', 'error');
                    log('IndexedDB: ã‚¨ãƒ©ãƒ¼', 'error');
                };
                request.onsuccess = () => {
                    addStatus('storage-tests', 'âœ… IndexedDB: æ­£å¸¸å‹•ä½œ', 'success');
                    log('IndexedDB: æ­£å¸¸å‹•ä½œ', 'success');
                    request.result.close();
                    indexedDB.deleteDatabase('test-db');
                };
            } catch (error) {
                addStatus('storage-tests', 'âŒ IndexedDB: ã‚¨ãƒ©ãƒ¼', 'error');
                log(`IndexedDB: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
            }
        }

        // CSSèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ
        async function runCSSTests() {
            log('ğŸ¨ CSSèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            const cssFiles = [
                '/src/styles/style.css',
                '/src/styles/login.css',
                '/src/styles/common.css'
            ];

            for (const cssFile of cssFiles) {
                try {
                    const response = await fetch(cssFile);
                    if (response.ok) {
                        addStatus('css-tests', `âœ… ${cssFile}: èª­ã¿è¾¼ã¿å¯èƒ½`, 'success');
                        log(`${cssFile}: èª­ã¿è¾¼ã¿å¯èƒ½`, 'success');
                    } else {
                        addStatus('css-tests', `âŒ ${cssFile}: èª­ã¿è¾¼ã¿ä¸å¯ (${response.status})`, 'error');
                        log(`${cssFile}: èª­ã¿è¾¼ã¿ä¸å¯ - ${response.status}`, 'error');
                    }
                } catch (error) {
                    addStatus('css-tests', `âŒ ${cssFile}: ã‚¨ãƒ©ãƒ¼`, 'error');
                    log(`${cssFile}: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
                }
            }
        }

        // è¨ºæ–­å®Ÿè¡Œ
        window.addEventListener('load', async () => {
            log('ğŸš€ è¨ºæ–­é–‹å§‹');
            
            runBasicTests();
            await runModuleTests();
            await runStorageTests();
            await runCSSTests();
            
            log('âœ… è¨ºæ–­å®Œäº†');
        });

        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', (event) => {
            log(`âŒ ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼: ${event.message}`, 'error');
        });

        window.addEventListener('unhandledrejection', (event) => {
            log(`âŒ æœªå‡¦ç†ã®Promiseæ‹’å¦: ${event.reason}`, 'error');
        });
    </script>
</body>
</html> 